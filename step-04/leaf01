---
- hosts: leaf01
  name: push yaml file and activate
  become: yes
  gather_facts: no
  tasks:
    - name: 1 yaml file
      copy:
        src: /home/cumulus/ON-15/inventory/files/leaf01-after-step0x
        dest: /etc/nvue.d/startup.yaml
    - name: 2 activate config
      ansible.builtin.shell: nv config apply startup -y
      
    - name: 3 unset
      copy:
        src: /home/cumulus/ON-15/inventory/files/leaf01-unset-step04
        dest: /home/cumulus/leaf01-unset-step04.yaml
    - name: 4 patch 
      ansible.builtin.shell: nv config patch /home/cumulus/leaf01-unset-step04.yaml
    - name: 5 apply config
      ansible.builtin.shell: nv config apply startup -y  
      
    - name: 6 get patch
      copy:
        src: /home/cumulus/ON-15/inventory/files/leaf01-patch-step04
        dest: /home/cumulus/leaf01-patch-step04.yaml
    - name: 7 patch 
      ansible.builtin.shell: nv config patch /home/cumulus/leaf01-patch-step04.yaml
    - name: 8 apply config
      ansible.builtin.shell: nv config apply startup -y   
      
    - name: 9 save
      ansible.builtin.shell: nv config save
      ansible.builtin.shell: cat /etc/nvue.d/startup.yaml
      register: startup
    - debug: msg={{ startup.stdout }}
