---
- hosts: leaf01
  name: push yaml file and activate
  become: yes
  gather_facts: no
  tasks:
    - name: yaml file
      copy:
        src: /home/cumulus/ON-15/inventory/files/leaf01-after-step03
        dest: /etc/nvue.d/startup.yaml
    # ifreload
    - name: activate changes for Leaf01
      shell: nv config apply startup -y
    # prepare merge
    - name: L3 interfaces SVI and VRR
      copy:
        src: /home/cumulus/ON-15/inventory/files/leaf01-L3
        dest: /home/cumulus/leaf01-L3
    - name: empty set
      copy: 
        src: /home/cumulus/ON-15/inventory/files/leaf01-if-unset
        dest: /home/cumulus/leaf01-if-unset
    - name: unset
      shell: nv config patch /home/cumulus/leaf01-if-unset
    - name: apply
      shell: nv config apply -y
    - name: patch
      shell: nv config patch /home/cumulus/leaf01-L3
    - name: apply
      shell: nv config apply -y
