---
- hosts: task-leaf  
  name: TOR
  become: yes
  gather_facts: no
    
  tasks:
    - name: copy eni
      copy: 
        src: /home/cumulus/ON-15/step-06c/{{ inventory_hostname }}-if
        dest: /etc/network/interfaces
    - name: activate changes on leaf01
      shell: /sbin/ifreload -a     

    - name: copy frr
      copy:
        src: /home/cumulus/ON-15/step-06c/{{ inventory_hostname }}-frr
        dest: /etc/frr/frr.conf
    - name: reload frr
      ansible.builtin.shell: systemctl reload frr
  
- hosts: localhost 
  name: task-step
  become: yes
  gather_facts: no
  
  vars:
    loopback_ips:
      lo_ip: 8.8.8.8/32
  
  tasks:
    - name: render file via template
      template: 
        src: /home/cumulus/ON-15/step-06c/templates/leaf01-if.j2
        dest: /home/cumulus/ON-15/step-06c/rendered-leaf01-if
       
- hosts: leaf01 
  name: task-step
  become: yes
  gather_facts: no

    - name: copy frr
      copy:
        src: /home/cumulus/ON-15/step-06c/rendered-leaf01-if
        dest: /etc/network/interfaces
    - name: kick it
      ansible.builtin.shell: /sbin/ifreload -a  
